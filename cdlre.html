<!DOCTYPE html>
<html>
    <head>
        <title>cdlre - JS-regexp in JS</title>
        <script type='text/javascript' src='cdlre/common.js'></script>
        <script type='text/javascript' src='cdlre/set.js'></script>
        <script type='text/javascript' src='cdlre/log.js'></script>
        <script type='text/javascript' src='cdlre/unicat.js'></script>
        <script type='text/javascript' src='cdlre/unicode.js'></script>
        <script type='text/javascript' src='cdlre/parser.js'></script>
        <script type='text/javascript' src='cdlre/matcher.js'></script>
        <script type='text/javascript' src='cdlre/cdlre.js'></script>
        <script type='text/javascript' src='cdlre/cdlre_test.js'></script>
        <script type='text/javascript'>
            function print() {
                var output = document.getElementById('re-output');
                for (var i = 0; i < arguments.length; ++i)
                    output.value += arguments[i];
                output.value += '\n';
            }

            function clearOutput() {
                var output = document.getElementById('re-output');
                output.value = '';
            }

            function getLiteralAndInput() {
                var literalStr = document.getElementById('re-literal').value;
                var inputStr = document.getElementById('re-input').value;
                print('Evaluating literal string: ', literalStr);
                var literal = eval(literalStr);
                return [literal, inputStr];
            }

            function runRegExp() {
                cdlre.runRegExp.apply(null, getLiteralAndInput());
            }

            function checkAgainstHost() {
                var tup = getLiteralAndInput();
                var literal = tup[0];
                var input = tup[1];
                try {
                    cdlre.test.checkAgainstHost(literal.source, cdlre.flagsToString(literal), input);
                } catch (e) {
                    if (e.message !== 'failure') {
                        pfmt('{}\n{}', e, e.stack);
                        throw e;
                    }
                }
            }
        </script>
        <style type='text/css'>
            .full-textarea textarea {
                font-family: monospace;
                width: 100%;
            }
        </style>
    </head>
    <body>
        <form onsubmit='return runRegExp();'>
            <label for='re-literal'>RegExp literal</label>
            <input id='re-literal' value='//' />
            <br />
            <label for='re-input'>RegExp input</label>
            <input id='re-input' />
            <br />
            <input type='submit' value='Clear Output' onclick='clearOutput(); return false;' />
            <input type='submit' value='Run' onclick='runRegExp(); return false;'/>
            <input type='submit' value='Versus Host' onclick='checkAgainstHost(); return false;' />
            <br />
            <div class='full-textarea'>
                <textarea id='re-output' cols='80' rows='24' value=''></textarea>
            </div>
        </form>
        <script type='text/javascript'>
            var output = document.getElementById('re-output');
            output.value = '';
            testCDLRE();
        </script>
    </body>
</html>
